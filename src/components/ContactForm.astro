---

---

<form action="POST" class="flow" novalidate>
  <input type="hidden" name="access_key" value="cfca30b9-3e42-4823-8a26-fd730ee1695e" />

  <div class="form-group">
    <label for="name" class="visually-hidden">Name</label>
    <input
      type="text"
      name="name"
      id="name"
      required
      placeholder="Name"
      autocomplete="name"
      aria-describedby="nameError"
      data-error="Please enter your name"
    />
    <span id="nameError" class="error" aria-live="polite"></span>
  </div>

  <div class="form-group">
    <label for="email" class="visually-hidden">Email</label>
    <input
      type="email"
      name="email"
      id="email"
      required
      placeholder="Email"
      autocomplete="email"
      aria-describedby="emailError"
      data-error="Please enter a valid email"
    />
    <span id="emailError" class="error" aria-live="polite"></span>
  </div>

  <div class="form-group">
    <label for="message" class="visually-hidden">Message</label>
    <textarea
      name="message"
      id="message"
      required
      placeholder="Message..."
      aria-describedby="messageError"
      data-error="Please enter your message"></textarea>
    <span id="messageError" class="error" aria-live="polite"></span>
  </div>

  <button type="submit">Send Message</button>
  <span class="result" role="status"></span>
</form>

<style>
  form {
    --flow-space: 1.5rem;
    max-width: 25rem;
    margin-inline: auto;
  }

  input,
  textarea,
  button {
    width: 100%;
  }

  input,
  textarea {
    padding-inline: 1em;
    padding-block: 0.5em;
    border-radius: 0.75rem;
    border: 3px solid var(--clr-primary-300);
    background: inherit;
    color: inherit;
  }

  textarea {
    height: 5lh;
  }

  ::placeholder {
    color: hsl(from var(--clr-neutral-100) h s l / 0.8);
  }

  button {
    border-radius: 0.5rem;
    padding-inline: 1em;
    padding-block: 0.75em;
    border: none;
    background-color: var(--clr-primary-300);
    color: var(--clr-neutral-100);
    font-weight: var(--fw-bold);
    cursor: pointer;
    transition: background 300ms;
  }

  button:is(:hover, :focus-visible) {
    background-color: var(--clr-primary-400);
  }

  button:active {
    scale: 0.9;
  }

  form span {
    display: block;
    margin-block-start: 1rem;
  }

  .error {
    color: var(--clr-error);
  }

  .success {
    color: var(--clr-success);
  }
</style>

<script>
  const form = document.querySelector(".contact form");
  const inputs = form?.querySelectorAll("input, textarea");
  const resultEl = form?.querySelector(".result");
  let isValid = true;

  function checkError(e) {
    const input = e.target;
    const errorEl = input.parentElement.querySelector(".error");
    const errorText = input.dataset.error;
    const hasError = !input.checkValidity();

    if (hasError) {
      errorEl.textContent = errorText;
      isValid = false;
    }
  }

  function clearError(e) {
    const input = e.target;
    const errorEl = input.parentElement.querySelector(".error");
    errorEl.textContent = "";
    resultEl.textContent = "";
    isValid = true;
  }

  inputs?.forEach((input) => {
    input.addEventListener("blur", checkError);
  });

  inputs?.forEach((input) => {
    input.addEventListener("input", clearError);
  });

  async function handleSubmit(e) {
    e.preventDefault();

    isValid = e.target.checkValidity();

    if (!isValid) {
      console.log(isValid);
      inputs?.forEach((input) => {
        const errorEl = input.parentElement?.querySelector(".error");
        if (errorEl) errorEl.textContent = input.dataset.error;
      });
      return;
    }

    const formData = new FormData(e.target);
    const object = Object.fromEntries(formData);
    const json = JSON.stringify(object);

    const response = await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      body: json,
      headers: { "Content-Type": "application/json", Accept: "application/json" },
    });

    if (response.ok) {
      resultEl?.classList.remove("error");
      resultEl?.classList.add("success");
      resultEl.textContent = "Your message has been sent!";
      e.target.reset();
    } else {
      resultEl?.classList.remove("success");
      resultEl?.classList.add("error");
      resultEl.textContent = "Error submitting form, please try again.";
    }
  }

  form?.addEventListener("submit", handleSubmit);
</script>
